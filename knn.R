con <- dbConnect(dbDriver("SQLite"), dbname = '~/repositories/prediggit2b/Apr1-15/sample1.db')


tr1 = dbGetQuery(con, "select time,attention,user,domain,topic, headlineWord1, headlineWord2, headlineWord3, headlineWord4, headlineWord5, headlineWord6, headlineWord7, headlineWord8, headlineWord9, headlineWord10, headlineWord11, headlineWord12, headlineWord13, headlineWord14, headlineWord15, headlineWord16, headlineWord17, headlineWord18, headlineWord19, headlineWord20, headlineWord21, headlineWord22, headlineWord23, headlineWord24, headlineWord25, headlineWord26, headlineWord27, headlineWord28, headlineWord29, headlineWord30, headlineWord31, headlineWord32, headlineWord33, headlineWord34, headlineWord35, headlineWord36, headlineWord37, headlineWord38, headlineWord39, headlineWord40, headlineWord41, headlineWord42, headlineWord43, headlineWord44, headlineWord45, headlineWord46, headlineWord47, headlineWord48, headlineWord49, headlineWord50, headlineWord51, headlineWord52, headlineWord53, headlineWord54, headlineWord55, headlineWord56, headlineWord57, headlineWord58, headlineWord59, headlineWord60, headlineWord61, headlineWord62, headlineWord63, headlineWord64, headlineWord65, headlineWord66, headlineWord67, headlineWord68, headlineWord69, headlineWord70, headlineWord71, headlineWord72, headlineWord73, headlineWord74, headlineWord75, headlineWord76, headlineWord77, headlineWord78, headlineWord79, headlineWord80, headlineWord81, headlineWord82, headlineWord83, headlineWord84, headlineWord85, headlineWord86, headlineWord87, headlineWord88, headlineWord89, headlineWord90, headlineWord91, headlineWord92, headlineWord93, headlineWord94, headlineWord95, headlineWord96, headlineWord97, headlineWord98, headlineWord99, headlineWord100, descriptionWord1, descriptionWord2, descriptionWord3, descriptionWord4, descriptionWord5, descriptionWord6, descriptionWord7, descriptionWord8, descriptionWord9, descriptionWord10, descriptionWord11, descriptionWord12, descriptionWord13, descriptionWord14, descriptionWord15, descriptionWord16, descriptionWord17, descriptionWord18, descriptionWord19, descriptionWord20, descriptionWord21, descriptionWord22, descriptionWord23, descriptionWord24, descriptionWord25, descriptionWord26, descriptionWord27, descriptionWord28, descriptionWord29, descriptionWord30, descriptionWord31, descriptionWord32, descriptionWord33, descriptionWord34, descriptionWord35, descriptionWord36, descriptionWord37, descriptionWord38, descriptionWord39, descriptionWord40, descriptionWord41, descriptionWord42, descriptionWord43, descriptionWord44, descriptionWord45, descriptionWord46, descriptionWord47, descriptionWord48, descriptionWord49, descriptionWord50, descriptionWord51, descriptionWord52, descriptionWord53, descriptionWord54, descriptionWord55, descriptionWord56, descriptionWord57, descriptionWord58, descriptionWord59, descriptionWord60, descriptionWord61, descriptionWord62, descriptionWord63, descriptionWord64, descriptionWord65, descriptionWord66, descriptionWord67, descriptionWord68, descriptionWord69, descriptionWord70, descriptionWord71, descriptionWord72, descriptionWord73, descriptionWord74, descriptionWord75, descriptionWord76, descriptionWord77, descriptionWord78, descriptionWord79, descriptionWord80, descriptionWord81, descriptionWord82, descriptionWord83, descriptionWord84, descriptionWord85, descriptionWord86, descriptionWord87, descriptionWord88, descriptionWord89, descriptionWord90, descriptionWord91, descriptionWord92, descriptionWord93, descriptionWord94, descriptionWord95, descriptionWord96, descriptionWord97, descriptionWord98, descriptionWord99, descriptionWord100 from trainingset WHERE popular = '0'")
tr2 = dbGetQuery(con, "select time,attention,user,domain,topic, headlineWord1, headlineWord2, headlineWord3, headlineWord4, headlineWord5, headlineWord6, headlineWord7, headlineWord8, headlineWord9, headlineWord10, headlineWord11, headlineWord12, headlineWord13, headlineWord14, headlineWord15, headlineWord16, headlineWord17, headlineWord18, headlineWord19, headlineWord20, headlineWord21, headlineWord22, headlineWord23, headlineWord24, headlineWord25, headlineWord26, headlineWord27, headlineWord28, headlineWord29, headlineWord30, headlineWord31, headlineWord32, headlineWord33, headlineWord34, headlineWord35, headlineWord36, headlineWord37, headlineWord38, headlineWord39, headlineWord40, headlineWord41, headlineWord42, headlineWord43, headlineWord44, headlineWord45, headlineWord46, headlineWord47, headlineWord48, headlineWord49, headlineWord50, headlineWord51, headlineWord52, headlineWord53, headlineWord54, headlineWord55, headlineWord56, headlineWord57, headlineWord58, headlineWord59, headlineWord60, headlineWord61, headlineWord62, headlineWord63, headlineWord64, headlineWord65, headlineWord66, headlineWord67, headlineWord68, headlineWord69, headlineWord70, headlineWord71, headlineWord72, headlineWord73, headlineWord74, headlineWord75, headlineWord76, headlineWord77, headlineWord78, headlineWord79, headlineWord80, headlineWord81, headlineWord82, headlineWord83, headlineWord84, headlineWord85, headlineWord86, headlineWord87, headlineWord88, headlineWord89, headlineWord90, headlineWord91, headlineWord92, headlineWord93, headlineWord94, headlineWord95, headlineWord96, headlineWord97, headlineWord98, headlineWord99, headlineWord100, descriptionWord1, descriptionWord2, descriptionWord3, descriptionWord4, descriptionWord5, descriptionWord6, descriptionWord7, descriptionWord8, descriptionWord9, descriptionWord10, descriptionWord11, descriptionWord12, descriptionWord13, descriptionWord14, descriptionWord15, descriptionWord16, descriptionWord17, descriptionWord18, descriptionWord19, descriptionWord20, descriptionWord21, descriptionWord22, descriptionWord23, descriptionWord24, descriptionWord25, descriptionWord26, descriptionWord27, descriptionWord28, descriptionWord29, descriptionWord30, descriptionWord31, descriptionWord32, descriptionWord33, descriptionWord34, descriptionWord35, descriptionWord36, descriptionWord37, descriptionWord38, descriptionWord39, descriptionWord40, descriptionWord41, descriptionWord42, descriptionWord43, descriptionWord44, descriptionWord45, descriptionWord46, descriptionWord47, descriptionWord48, descriptionWord49, descriptionWord50, descriptionWord51, descriptionWord52, descriptionWord53, descriptionWord54, descriptionWord55, descriptionWord56, descriptionWord57, descriptionWord58, descriptionWord59, descriptionWord60, descriptionWord61, descriptionWord62, descriptionWord63, descriptionWord64, descriptionWord65, descriptionWord66, descriptionWord67, descriptionWord68, descriptionWord69, descriptionWord70, descriptionWord71, descriptionWord72, descriptionWord73, descriptionWord74, descriptionWord75, descriptionWord76, descriptionWord77, descriptionWord78, descriptionWord79, descriptionWord80, descriptionWord81, descriptionWord82, descriptionWord83, descriptionWord84, descriptionWord85, descriptionWord86, descriptionWord87, descriptionWord88, descriptionWord89, descriptionWord90, descriptionWord91, descriptionWord92, descriptionWord93, descriptionWord94, descriptionWord95, descriptionWord96, descriptionWord97, descriptionWord98, descriptionWord99, descriptionWord100 from trainingset WHERE popular = '1'")
train = rbind(tr1,tr2)

con <- dbConnect(dbDriver("SQLite"), dbname = '~/repositories/prediggit2b/Apr1-15/testset.db')

te1 = dbGetQuery(con, "select time,attention,user,domain,topic, headlineWord1, headlineWord2, headlineWord3, headlineWord4, headlineWord5, headlineWord6, headlineWord7, headlineWord8, headlineWord9, headlineWord10, headlineWord11, headlineWord12, headlineWord13, headlineWord14, headlineWord15, headlineWord16, headlineWord17, headlineWord18, headlineWord19, headlineWord20, headlineWord21, headlineWord22, headlineWord23, headlineWord24, headlineWord25, headlineWord26, headlineWord27, headlineWord28, headlineWord29, headlineWord30, headlineWord31, headlineWord32, headlineWord33, headlineWord34, headlineWord35, headlineWord36, headlineWord37, headlineWord38, headlineWord39, headlineWord40, headlineWord41, headlineWord42, headlineWord43, headlineWord44, headlineWord45, headlineWord46, headlineWord47, headlineWord48, headlineWord49, headlineWord50, headlineWord51, headlineWord52, headlineWord53, headlineWord54, headlineWord55, headlineWord56, headlineWord57, headlineWord58, headlineWord59, headlineWord60, headlineWord61, headlineWord62, headlineWord63, headlineWord64, headlineWord65, headlineWord66, headlineWord67, headlineWord68, headlineWord69, headlineWord70, headlineWord71, headlineWord72, headlineWord73, headlineWord74, headlineWord75, headlineWord76, headlineWord77, headlineWord78, headlineWord79, headlineWord80, headlineWord81, headlineWord82, headlineWord83, headlineWord84, headlineWord85, headlineWord86, headlineWord87, headlineWord88, headlineWord89, headlineWord90, headlineWord91, headlineWord92, headlineWord93, headlineWord94, headlineWord95, headlineWord96, headlineWord97, headlineWord98, headlineWord99, headlineWord100, descriptionWord1, descriptionWord2, descriptionWord3, descriptionWord4, descriptionWord5, descriptionWord6, descriptionWord7, descriptionWord8, descriptionWord9, descriptionWord10, descriptionWord11, descriptionWord12, descriptionWord13, descriptionWord14, descriptionWord15, descriptionWord16, descriptionWord17, descriptionWord18, descriptionWord19, descriptionWord20, descriptionWord21, descriptionWord22, descriptionWord23, descriptionWord24, descriptionWord25, descriptionWord26, descriptionWord27, descriptionWord28, descriptionWord29, descriptionWord30, descriptionWord31, descriptionWord32, descriptionWord33, descriptionWord34, descriptionWord35, descriptionWord36, descriptionWord37, descriptionWord38, descriptionWord39, descriptionWord40, descriptionWord41, descriptionWord42, descriptionWord43, descriptionWord44, descriptionWord45, descriptionWord46, descriptionWord47, descriptionWord48, descriptionWord49, descriptionWord50, descriptionWord51, descriptionWord52, descriptionWord53, descriptionWord54, descriptionWord55, descriptionWord56, descriptionWord57, descriptionWord58, descriptionWord59, descriptionWord60, descriptionWord61, descriptionWord62, descriptionWord63, descriptionWord64, descriptionWord65, descriptionWord66, descriptionWord67, descriptionWord68, descriptionWord69, descriptionWord70, descriptionWord71, descriptionWord72, descriptionWord73, descriptionWord74, descriptionWord75, descriptionWord76, descriptionWord77, descriptionWord78, descriptionWord79, descriptionWord80, descriptionWord81, descriptionWord82, descriptionWord83, descriptionWord84, descriptionWord85, descriptionWord86, descriptionWord87, descriptionWord88, descriptionWord89, descriptionWord90, descriptionWord91, descriptionWord92, descriptionWord93, descriptionWord94, descriptionWord95, descriptionWord96, descriptionWord97, descriptionWord98, descriptionWord99, descriptionWord100 from testset WHERE popular = '0'")
te2 = dbGetQuery(con, "select time,attention,user,domain,topic, headlineWord1, headlineWord2, headlineWord3, headlineWord4, headlineWord5, headlineWord6, headlineWord7, headlineWord8, headlineWord9, headlineWord10, headlineWord11, headlineWord12, headlineWord13, headlineWord14, headlineWord15, headlineWord16, headlineWord17, headlineWord18, headlineWord19, headlineWord20, headlineWord21, headlineWord22, headlineWord23, headlineWord24, headlineWord25, headlineWord26, headlineWord27, headlineWord28, headlineWord29, headlineWord30, headlineWord31, headlineWord32, headlineWord33, headlineWord34, headlineWord35, headlineWord36, headlineWord37, headlineWord38, headlineWord39, headlineWord40, headlineWord41, headlineWord42, headlineWord43, headlineWord44, headlineWord45, headlineWord46, headlineWord47, headlineWord48, headlineWord49, headlineWord50, headlineWord51, headlineWord52, headlineWord53, headlineWord54, headlineWord55, headlineWord56, headlineWord57, headlineWord58, headlineWord59, headlineWord60, headlineWord61, headlineWord62, headlineWord63, headlineWord64, headlineWord65, headlineWord66, headlineWord67, headlineWord68, headlineWord69, headlineWord70, headlineWord71, headlineWord72, headlineWord73, headlineWord74, headlineWord75, headlineWord76, headlineWord77, headlineWord78, headlineWord79, headlineWord80, headlineWord81, headlineWord82, headlineWord83, headlineWord84, headlineWord85, headlineWord86, headlineWord87, headlineWord88, headlineWord89, headlineWord90, headlineWord91, headlineWord92, headlineWord93, headlineWord94, headlineWord95, headlineWord96, headlineWord97, headlineWord98, headlineWord99, headlineWord100, descriptionWord1, descriptionWord2, descriptionWord3, descriptionWord4, descriptionWord5, descriptionWord6, descriptionWord7, descriptionWord8, descriptionWord9, descriptionWord10, descriptionWord11, descriptionWord12, descriptionWord13, descriptionWord14, descriptionWord15, descriptionWord16, descriptionWord17, descriptionWord18, descriptionWord19, descriptionWord20, descriptionWord21, descriptionWord22, descriptionWord23, descriptionWord24, descriptionWord25, descriptionWord26, descriptionWord27, descriptionWord28, descriptionWord29, descriptionWord30, descriptionWord31, descriptionWord32, descriptionWord33, descriptionWord34, descriptionWord35, descriptionWord36, descriptionWord37, descriptionWord38, descriptionWord39, descriptionWord40, descriptionWord41, descriptionWord42, descriptionWord43, descriptionWord44, descriptionWord45, descriptionWord46, descriptionWord47, descriptionWord48, descriptionWord49, descriptionWord50, descriptionWord51, descriptionWord52, descriptionWord53, descriptionWord54, descriptionWord55, descriptionWord56, descriptionWord57, descriptionWord58, descriptionWord59, descriptionWord60, descriptionWord61, descriptionWord62, descriptionWord63, descriptionWord64, descriptionWord65, descriptionWord66, descriptionWord67, descriptionWord68, descriptionWord69, descriptionWord70, descriptionWord71, descriptionWord72, descriptionWord73, descriptionWord74, descriptionWord75, descriptionWord76, descriptionWord77, descriptionWord78, descriptionWord79, descriptionWord80, descriptionWord81, descriptionWord82, descriptionWord83, descriptionWord84, descriptionWord85, descriptionWord86, descriptionWord87, descriptionWord88, descriptionWord89, descriptionWord90, descriptionWord91, descriptionWord92, descriptionWord93, descriptionWord94, descriptionWord95, descriptionWord96, descriptionWord97, descriptionWord98, descriptionWord99, descriptionWord100 from testset WHERE popular = '1'")
test = rbind(te1,te2)

tr1Size = sum(!is.na(tr1))
tr2Size = sum(!is.na(tr2))

cl <- factor(c(rep("u", tr1Size), rep("p", tr2Size)))
knn(train, test, cl, k = 3, prob=TRUE)

